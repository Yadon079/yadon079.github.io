---
layout: post
date: 2021-05-05 23:20:00
title: "서블릿 컨테이너(Servlet Container)란?"
description: "웹 서버, 서블릿 컨테이너, JVM"
subject: java
category: [ java ]
tags: [ java, servlet servlet container, web server ]
use_math: true
comments: true
---

# 1. 웹 서버란?

### 웹 페이지를 사용자에게 전송.

서블릿 컨테이너를 알기 전에 웹 서버에 대한 이해가 먼저 필요하다.

<img src="/assets/img/study/img01.jpg" width="70%" align="center"><br/>

웹 서버는 데이터를 전송하기 위해 HTTP 프로토콜을 사용한다. 일반적인 상황에서 사용자는 브라우저에 URL(e.g. www.programcreek.com/static.html)을 입력하고 웹 페이지를 얻게 된다. 웹 서버가 하는 일은 웹 페이지를 사용자에게 전송하는 것이다. 변화하는 것은 <b>HTTP 프로토콜에서 형식이 지정되는 요청과 반응 메세지</b>이다.

# 2. 서블릿 컨테이너란?

### 서블릿 컨테이너는 서블릿들의 생성, 실행, 파괴를 담당.

아래의 그림처럼, 사용자는 서버에 오직 정적인 웹 페이지만 요청할 수 있다. 만약 사용자가 본인의 입력을 토대로한 웹 페이지를 보고 싶다면 이 방법은 충분하지 않다. 서블릿 컨테이너의 일반적인 아이디어는 서버 사이드에서 동적으로 웹 페이지를 생성하기 위해 자바를 사용하는 것이다. 그렇기 떄문에 웹 서버와 서블릿들이 상호작용 할 때 서블릿 컨테이너는 필수적인 부분이다.

<img src="/assets/img/study/img02.jpg" width="70%" align="center"><br/>

# 3. 서블릿이란?

### javax.servlet package에 정의된 인터페이스. 요청을 처리함.

서블릿이란 <b>javax.servlet package에 정의된 인터페이스</b>이다. 이것은 <b>서블릿의 라이프 사이클을 위한 세 가지 필수적인 메서드 `init()`, `service()`, `destroy()`</b>를 정의한다. 이 메서드들은 SDK[^1]에서 정의되거나 자체적으로 정의된 모든 서블릿에 의해 구현되고, 서버에 의해서 특정 시간에 호출된다.

<b>&#49;. init()</b>

&nbsp;&nbsp;&nbsp;init()은 서블릿 라이프 사이클 중 <b>초기화 단계</b>에서 호출된다. <b>javax.servlet.ServletConfig 인터페이스를 구현하는 오브젝트가 전달</b>되며, 이를 통해 서블릿이 웹 애플리케이션에서 초기화 매개변수(parameter)에 접근할 수 있도록 한다.

<b>&#50;. service()</b>

&nbsp;&nbsp;&nbsp;초기화 이후 각각의 <b>요청들이 들어올 때</b> 호출된다. 각각의 요청들은 별도로 나뉘어진 쓰레드에서 처리된다.  
웹 컨테이너는 모든 요청에 대해 service() 메서드를 요청한다. service() 메서드는 요청의 종류를 판별하고 요청을 처리할 적절한 메서드로 전달한다.

<b>&#51;. destroy()</b>

&nbsp;&nbsp;&nbsp;destroy() 메서드는 <b>서블릿 객체가 파괴되어야 할 때</b> 호출된다. 해당 서블릿이 가지고 있던 자원(메모리)을 풀어준다(release).

서블릿 객체의 라이프 사이클에서 서블릿 클래스가 클래스 로더에 의해 컨테이너에 동적으로 로드되는 것을 볼 수 있다.  
각 요청은 자체적인 쓰레드에 있으며, 서블릿 객체는 동시에 여러 개의 쓰레드를 제공할 수 있다.(htread not safe).  
더 이상 사용되지 않을 때는, JVM에 의해 GC 되어야 한다.

다른 자바 프로그램처럼 서블릿들은 JVM 내부에서 작동한다. HTTP 요청들의 복잡성을 처리하기 위해서 서블릿 컨테이너가 제공된다.

# 4. 서블릿 컨테이너와 웹 서버는 어떻게 요청을 처리할까?

1. 웹 서버가 HTTP 요청을 받는다.
2. 웹 서버는 요청을 서블릿 컨테이너로 전달한다.
3. 서블릿이 컨테이너에 없다면, 서블릿을 동적으로 검색하여 컨테이너의 주소 공간에 로드한다.
4. 컨테이너가 서블릿의 init() 메서드를 호출하면, 서블릿이 초기화된다.(서블릿이 처음 로드 되었을 때 한 번만 호출된다.)
5. 컨테이너가 서블릿의 service() 메서드를 호출하여 HTTP 요청을 처리한다. 서블릿은 컨테이너 주소에 남아있고, 다른 HTTP 요청들을 처리할 수 있다.
6. 웹 서버는 동적으로 생성된 결과를 올바른 위치에 반환한다.

아래의 그림은 위의 여섯 단계를 나타낸 것이다.

<img src="/assets/img/study/img03.jpg" width="70%" align="center"><br/>

# 5. JVM의 역할은?

### 각 요청을 분리된 자바 쓰레드 내부에서 처리

서블릿을 사용하는 것은 <b>JVM이 각 요청을 분리된 자바 쓰레드 내부에서 처리</b>하도록 하는 것이다. 이는 서블릿 컨테이너의 장점 중 하나이다.  
각 서블릿은 HTTP 요청에 응답하는 특별한 요소들이 있는 자바 클래스이다. 서블릿 컨테이너의 가장 중요한 기능은 요청을 올바른 서블릿에 전달해서 처리되도록 하고, JVM이 해당 요청을 처리한 후에는 생성된 결과를 올바른 장소에 동적으로 반환해주는 것이다.

대부분의 경우 서블릿 컨테이너는 하나의 JVM에서 동작하지만, 컨테이너가 여러 개의 JVM을 필요로 하는 문제들도 존재한다.

---
**출처**
+ <https://www.programcreek.com/2013/04/what-is-servlet-container>

---
[^1]:Software Development Kit
